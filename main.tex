\documentclass[a4paper]{article}

\usepackage{draftwatermark}
\usepackage{paralist}
\usepackage{authblk}
\usepackage{amsmath}
\usepackage{amsthm}

% TODO remove this in the final version
\newcommand{\keyword}[1]{\textbf{#1}}

\newcounter{main}
\newtheorem{prop}[main]{Proposition}
\newtheorem{cathm}[main]{Computer-aided Theorem}
\newtheorem{thm}[main]{Theorem}
\newtheorem{lem}[main]{Lemma}
\newtheorem{fact}[main]{Fact}
\theoremstyle{definition}
\newtheorem{dfn}[main]{Definition}
\newtheorem*{spin}{SPIN Axiom \cite{ck09}}
\theoremstyle{remark}
\newtheorem{rem}[main]{Remark}

% TODO this suggests only one result: the improved lower bound
%      reference to other results?
\title{A Kochen-Specker system has at least 22 vertices}

\author{Sander Uijlen}
\author{Bas Westerbaan}

% TODO will we keep these @cs.ru.nl addresses?
\affil{Institute for Computing and Information Sciences\\
       Radboud Universiteit Nijmegen\\
   \{\texttt{suijlen},\texttt{bwesterb}\}\texttt{@cs.ru.nl}}

\begin{document}

\maketitle

\begin{abstract}
    At the heart of the Conway's Free Will theorems and Kochen and Specker's
        argument against noncontextual hidden variable theories
    is the existence of a Kochen-Specker (KS) system:
    a set of points on the sphere,
    that has no~$\{0,1\}$-coloring such that
    at most one of two orthogonal points are colored~$1$
    and of three pairwise orthogonal points exactly one
    is colored~$1$.
    In public lectures, Conway encouraged the search for small
    KS systems.  
    At the time of writing, the smallest known
    KS system has 31 vectors.  

    Arends, Ouaknine and Wampler have shown that a KS system has at least
    18 vectors, by reducing the problem to the existence of graphs
    with a topological embeddability and non-colorability property.
    Deciding embeddability and the sheer number of graphs on more than~$17$
    vertices, proved the bottleneck in their search.

    Continuing their effort, we restrict our enumeration to smaller class of
    graphs and develop a practical decision procedure for embeddability, to
    improve the lower bound to 22.
\end{abstract}
    
\section{Introduction}

% TODO whose idea is this orthogonality graph
\subsection{The experiment}

% TODO correct description of experiment
Let's perform the following experiment.  Shoot a deuterium atom,
or any other spin-1 particle,
along, say: the x-axis, through a uniform magnetic field.
Depending on the direction of the magnetic field,
the particle will move undisturbed
or deviate.

Quantum Mechanics only predicts the chance, given the initial configuration
of the field, whether the particle will deviate.
Its probabilistic prediction has been thouroughly tested.
One wonders: is there a deterministic theory predicting the
outcome of this experiment?

Kochen and Specker proved that such a theory cannot satisfy:
% TODO note contextuality
\begin{spin}
    Given three pairwise orthogonal directions.
    In exactly one of the directions, the particle will not deviate.
\end{spin}
Their argument is based on the existence of a Kochen-Specker system.
\begin{dfn}
    A \keyword{Kochen-Specker (KS) system} is
    a finite set of points on the sphere
    for which each pair is not antipodal and
    there is no~\keyword{010-coloring}.
    A $010$-coloring is a~$\{0,1\}$-coloring of the points such that
    \begin{enumerate}
        \item
            no pair of orthogonal points are both colored~$1$ and
        \item
            of three pairwise orthogonal points exactly one is colored~$1$;
            or alternatively: they are colored~$0$, $1$ and~$0$ in some order.
    \end{enumerate}
\end{dfn}
% TODO shorten this proof.
For suppose there is a KS system and  a deterministic theory satisfying
the SPIN Axiom.
Then we color a point of the system~$0$,
whenever the theory predicts that the particle will deviate
if the magnetic field is directed along that point and~$1$ otherwise.
Given two orthogonal points of the system,
we can find a third point orthogonal to both of them.
The SPIN axiom implies exactly one of them is colored~$1$.
Thus they cannot both be colored~$1$.
And similarly, given three pairwise orthogonal vectors in the system,
the SPIN axiom implies exactly one of them is colored~$1$.
Hence the KS system is 010-colorable, quod non.  Thus the deterministic theory
cannot satisfy the SPIN Axiom.

The KS system proposed by Kochen and Specker contained 117 points\cite{ks}.
% TODO reference (x2)
Penrose and Peres independently found a smaller system of 33 points.
The current record is the 31 point system of Conway.
As pointed out by \cite{c00,aow11}, finding small KS systems
is of both theoretical and practical interest.
In public lectures, Conway himself, stressed the search for small KS systems.

% TODO refer to non-3d systems
In \cite{aow11} Arends, Ouaknine and Wampler give a computer aided proof
that a KS system must have at least 18 vectors.  We improve their lower bound
and show that a KS must have at least 22 vectors.

\subsection{The 33 vector KS system of Penrose and Peres}
TODO

\subsection{Kochen-Specker graphs}
We follow \cite{aow11} and reduce the search for Kochen-Specker systems
to the search of a certain class of graphs.
First note that in a Kochen-Specker system we may replace a point with its
antipodal point.  They are both orthogonal to the same points and hence
the non-010-colorability is preserved.
Thus, we may assume antipodal points are identified on the sphere.
That is: a Kochen-Specker system is a finite subset of the projective plane
that is not 010-colorable.
\begin{dfn}
Given a finite subset~$S$ of the projective plane
(or equivalently, of the northern hemisphere without equator).
Define its \keyword{orthogonality graph}~$G(S)$ as follows.
The vertices are the points of~$S$.
Two vertices are joined by an edge, if their corresponding points
are orthogonal.
\end{dfn}
\begin{dfn}
A graph~$G$ is called~\keyword{embeddable},
if it occurs as a orthogonality graph;
that is: if there is a finite subset~$S$ of the projective plane,
such that~$G(S) = G$.
\end{dfn}
\begin{dfn}
A graph is~\keyword{010-colorable}
if there is a~$\{0,1\}$-coloring, such that
\begin{enumerate}
\item
for each triangle there is exactly one vertex that is colored~$1$ and
\item
adjacent vertices are not both colored~$1$.
\end{enumerate}
\end{dfn}
\begin{dfn}
A \keyword{Kochen-Specker graph}
is a embeddable graph that is not 010-colorable.
\end{dfn}
It is an easy, but important, consequence of the definitions that:
\begin{fact}
    A finite subset~$S$ of the projective plane
    is a Kochen-Specker system,
    if and only if its orthogonality graph~$G(S)$
    is Kochen-Specker.
\end{fact}
To prove there is no Kochen-Specker system on~$17$ points,
it is sufficient to enumerate all graphs on~$17$ vertices
and check they are not 010-colorable or not embeddable.
This is infeasable, there are~${\sim}10^{26}$ non-isomorphic
graphs on~$17$ points.
% TODO OEIS A000088
However, we can restrict ourselves to certain classes of graphs.
\begin{prop}[\cite{aow11}]
    An embeddable graph does not contain a square.
\end{prop}
\begin{proof}
    Given points~$a\neq b$.
    Consider the points orthogonal to~$a$.
    This is a great circle.
    The points orthognal to~$b$ is a different great circle.
    They intersect in precisely two antipodal points.
    Hence, if~$c$ and~$d$ are both orthogonal to~$a$ and~$b$,
    then~$c$ and~$d$ are equivalent.
    Thus in an embeddable graph, there cannot be a square~$acbd$.
\end{proof}
The squarefreeness is a considerable restriction.  There are
only~${\sim}10^{10}$ non-isomorphic squarefree graphs on~$17$ vertices.
We can restrict ourselves to connected graphs.
% TODO OEIS A006786
\begin{prop}[\cite{aow11}]
    A minimal Kochen-Specker graph is connected.
\end{prop}
\begin{proof}
    Suppose~$G$ is a non-connected Kochen-Specker graph.
    Then one of its components is not 010-colorable.
    As a subgraph of an embeddable graph, is embeddable,
    this component is embeddable as well.
    Hence it is a smaller connected Kochen-Specker graph.
\end{proof}
The gain, however, is small.
There are only~${\sim}10^9$ non-isomorphic squarefree graphs on~$17$
vertices that are not connected.
We have verified the main result of \cite{aow11}:
\begin{cathm}
The unique non-010-colorable squarefree connected graph on~$17$
vertices is. TODO
It is not embeddable, see TODO, and hence a Kochen-Specker
system has at least 18 points.
\end{cathm}

\section{An improved lower bound}
Continuing their effort, we consider another restriction.
\begin{prop}
    A minimal Kochen-Specker graph has minimal vertex-order three.
\end{prop}
\begin{proof}
    Given a Kochen-Specker graph~$G$.
    Suppose~$v$ is a vertex with order less than~$2$.
    Let~$G'$ be~$G$ with~$v$ removed.
    Clearly~$G'$ is embeddable.
    Suppose~$G'$ is 010-colorable.
    Then we can extend the coloring to a coloring of~$G$ as follows.
    If~$v$ is adjacent to only one or no vertex,
    then we can color~$v$ with~$0$.
    Suppose~$v$ is adjacent to two vertices, say~$w$ and~$w'$.
    If one of~$w$ or~$w'$ is colored~$1$, we can color~$v$ with~$0$.
    If both~$w$ and~$w'$ are colored~$0$, we can color~$v$ with~$1$.
    Thus~$G$ is 010-colorable, quod non.  Thus~$G'$ is a smaller
    Kochen-Specker graph.
\end{proof}
There are only~${\sim}10^7$
squarefree non-isomorphic graphs on 17 vertices with minimal vertex order 3.
Even though Arends, Ouaknine and Wampler
note this restriction once,
surprisingly, they did not restrict their graph enumeration
to graphs with minimal vertex order 3.

\begin{prop}
    
\end{prop}

\section{Embeddability}
TODO

\section{Future research}
TODO

\section{Acknowledgments}
We wish to thank the following for their generous contribution to the
distributed computation:
    the Digital Security group, Intelligent Systems group
    and the C\&CZ service of the Radboud University;
    Wouter Geraedts and
    Jille Timmermans.

% attribute mckay for answering questions?
\bibliography{main}{}
\bibliographystyle{plain}


\end{document}

% vim: ft=tex.latex
