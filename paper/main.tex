\documentclass{report}
\usepackage{ohm-ngc}

\usepackage{etoolbox}

% Adaptation of ohm-ngc's proof environment to allow for a
% "Proof of Proposition 2    lorum ipsum ..."
\newbool{qedplaced} % keeps track whether QED symbol has been placed
\newenvironment{myproof}[1][Proof]{%
    \newcommand{\placeqed}{\ifmmode\quad\hbox{\hfill \BK}%
                    \else\hfill \BK\vskip7pt%
                    \fi}%
    \global\boolfalse{qedplaced}%
    \newcommand{\qed}{\ifbool{qedplaced}% Places QED symbol if not placed
                              {}%
                              {\placeqed\global\booltrue{qedplaced}}}%
    \par\noindent{\bfseries #1}\hskip2em}{\qed}

\usepackage{algpseudocode}
\usepackage{breakurl}
\usepackage{hyperref}
\usepackage{paralist}
\usepackage{graphicx}
\usepackage{mdwlist}
\usepackage{amsmath}
\usepackage{wrapfig}
\usepackage{picins}
\usepackage{tikz}

\newcommand{\keyword}[1]{\textbf{#1}}

\newtheorem{fact}{Fact}[section]
\newtheorem{comp}{Computation}[section]
\newtheorem{algorithm}{Algorithm}[section]

\begin{document}
\title{A Kochen-Specker system has at least 22 vectors}
\author{Sander Uijlen \& Bas Westerbaan}{Radboud Universiteit, The Netherlands}
\E-mail{\{suijlen,bwesterb\}@cs.ru.nl}

\begin{abstract}
    At the heart of the Conway-Kochen
    Free Will Theorem and Kochen and Specker's
        argument against non-contextual hidden variable theories
    is the existence of a Kochen-Specker (KS) system:
    a set of points on the sphere
    that has no~$\{0,1\}$-coloring such that
    at most one of two orthogonal points are colored~$1$
    and of three pairwise orthogonal points exactly one
    is colored~$1$.
    In public lectures, Conway encouraged the search for small
    KS systems.
    At the time of writing, the smallest known
    KS system has 31 vectors.  

    Arends, Ouaknine and Wampler have shown that a KS system has at least
    18 vectors, by reducing the problem to the existence of graphs
    with a topological embeddability and non-colorability property.
    The bottleneck in their search
    proved to be the sheer number of graphs on more than~$17$
    vertices and deciding embeddability.

    Continuing their effort, we prove a restriction on the class of graphs
    we need to consider and develop a more practical decision procedure for
    embeddability to improve the lower bound to 22.
\end{abstract}

\clearpage
\section{Introduction}

% TODO whose idea is this orthogonality graph
\subsection{The experiment}
Consider the following experiment.  Shoot a deuterium
atom (or another neutral spin 1 particle)
through a certain fixed inhomogeneous magnetic field,
such as that in the Stern-Gerlach experiment.
The particle will then move undisturbed or deviate.
What we have done is measure the spin component%
\footnote{%
As we are only interested in whether the particle deviates or
    not, we actually only consider the square of the spin component.}
 of the particle
along a certain direction.  This direction depends on the specifics of the
field and the movement of the particle.

Quantum Mechanics only predicts the probability, given the direction,
whether the particle will deviate.
Its probabilistic prediction has been thoroughly tested.
One wonders: is there a
\emph{deterministic} theory predicting the
outcome of this experiment?

Kochen and Specker have shown that such a non-contextual deterministic
theory must be odd: it cannot satisfy the plausible SPIN
axiom, that is:

% HACK to make a unnumbered "SPIN Axiom" theore environment.
\begingroup\makeatletter\def\@thmcounter#1{}
\newtheorem{spin}{SPIN Axiom}
\begin{spin}[see \cite{ck09}]
    Given three pairwise orthogonal directions.
    In exactly one of the directions, the particle will not deviate.
\end{spin}
\def\@thmcounter#1{\noexpand\arabic{#1}}\makeatother\endgroup
% /HACK

Their argument is based on the existence of a Kochen-Specker system.
\begin{definition}
    A \keyword{Kochen-Specker (KS) system} is
    a finite set of points on the sphere\footnote{
            We define KS systems to be three dimensional,
            as in the original proof of Kochen and Specker.
            Later, higher dimensional systems have been studied.
            See, for instance~\cite[p.~201]{qtcm}.
        }
    for which each pair is not antipodal and
    there is no~\keyword{010-coloring}.
    A $010$-coloring is a~$\{0,1\}$-coloring of the points such that%
        \footnote{
                In other papers, like \cite{aow11},
                the~$0$ and~$1$ are swapped; they consider 101-colorings.
                These colorings are of course equivalent and the
                difference arises from considering either squared
                spin measurements $S_v^2$, or $1-S_v^2$
                for spin in direction~$v$.
                %Then the colors correspond directly to the squared measurement
               	%outcome of the spin.
               	}
    \begin{enumerate}
        \item
            no pair of orthogonal points are both colored~$1$ and
        \item
            of three pairwise orthogonal points exactly one is colored~$1$;
            or alternatively: they are colored~$0$, $1$ and~$0$ in some order.
    \end{enumerate}
\end{definition}
% TODO shorten this proof.
A point on the sphere obviously corresponds to a direction in space.
Because of this, the terms point, vector and direction
can be used interchangeably. Antipodal points correspond to opposite
vectors and these span the same direction in space.

\piccaption{John Conway's 31 vector Kochen-Specker system\label{fig:conway31}}
\parpic[r]{%
%  Based on  <http://www.latex-community.org/viewtopic.php?f=4&t=2111>
\begin{tikzpicture}[scale=0.75,
        style={inner sep=0pt,%
              outer sep=2pt,%
              mark coordinate/.style={%
                inner sep=0pt,outer sep=0pt,minimum size=4pt,
                fill=black,circle}%
            }]
\def\R{2.5} % sphere radius
\def\St{1.41421356237}
\def\ST{1.73205080757}
\filldraw[ball color=white] (0,0) circle (\R);
\coordinate[mark coordinate] (N) at (0,0);
\coordinate[mark coordinate] (N) at (0,-\R/\St);
\coordinate[mark coordinate] (N) at (0,-\R*\St);
\coordinate[mark coordinate] (N) at (0,\R*\St/4);
\coordinate[mark coordinate] (N) at (0,\R*\St/2);
\coordinate[mark coordinate] (N) at (0,3*\R*\St/4);
\coordinate[mark coordinate] (N) at (-\R*\St*\ST/8,3*\R*\St/8);
\coordinate[mark coordinate] (N) at (-\R*\St*\ST/8,5*\R*\St/8);
\coordinate[mark coordinate] (N) at (-\R*\St*\ST/4,0);
\coordinate[mark coordinate] (N) at (-\R*\St*\ST/4,-\R*\St/4);
\coordinate[mark coordinate] (N) at (-\R*\St*\ST/4,-\R*\St/2);
\coordinate[mark coordinate] (N) at (-\R*\St*\ST/4,-3*\R*\St/4);
\coordinate[mark coordinate] (N) at (-\R*\St*\ST/4,\R*\St/4);
\coordinate[mark coordinate] (N) at (-\R*\St*\ST/4,\R*\St/2);
\coordinate[mark coordinate] (N) at (-3*\R*\St*\ST/8,\R*\St/8);
\coordinate[mark coordinate] (N) at (-3*\R*\St*\ST/8,-\R*\St/8);
\coordinate[mark coordinate] (N) at (-3*\R*\St*\ST/8,-3*\R*\St/8);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/8,3*\R*\St/8);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/8,5*\R*\St/8);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/8,-\R*\St/8);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/8,-3*\R*\St/8);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/8,-5*\R*\St/8);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/4,0);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/4,\R*\St/4);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/4,\R*\St/2);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/4,-\R*\St/4);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/4,-\R*\St/2);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/4,-3*\R*\St/4);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/2,-\R/\St);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/2,0);
\coordinate[mark coordinate] (N) at (\R*\St*\ST/2,\R/\St);
\draw (0,0) -- (0,-\R*\St) -- (-\R*\St*\ST/2,-\R/\St) --  (-\R*\St*\ST/2,\R/\St)
    --  (0,\R*\St) -- (\R*\St*\ST/2,\R/\St) 
    -- (\R*\St*\ST/2,-\R/\St) -- (0,- \R*\St);
\draw  (-\R*\St*\ST/2,\R/\St) -- (0,0) -- (\R*\St*\ST/2,\R/\St);
\draw (-\R*\St*\ST/4, -3*\R*\St/4) -- (-\R*\St*\ST/4,\R*\St/4 )
    -- (\R*\St*\ST/4, 3*\R*\St/4) ;
\draw (\R*\St*\ST/4, -3*\R*\St/4) -- (\R*\St*\ST/4,\R*\St/4 )
    -- (-\R*\St*\ST/4, 3*\R*\St/4) ;
\draw  (-\R*\St*\ST/2,{\R/\St - \R*\St/4}) -- (0,- \R*\St/4)
    -- (\R*\St*\ST/2,{\R/\St - \R*\St/4});
\draw  (-\R*\St*\ST/2,{\R/\St - \R*\St/2}) -- (0,- \R*\St/2)
    -- (\R*\St*\ST/2,{\R/\St - \R*\St/2});
\draw  (-\R*\St*\ST/2,{\R/\St - 3*\R*\St/4}) -- (0,- 3*\R*\St/4)
    -- (\R*\St*\ST/2,{\R/\St - 3*\R*\St/4});
\draw(-\R*\St*\ST/8,-0.25*7*\R/\St) -- (-\R*\St*\ST/8,{-0.25*7*\R/\St + \R*\St})
    -- (3*\R*\St*\ST/8,5*0.25*\R/\St);
\draw(\R*\St*\ST/8,-0.25*7*\R/\St) -- (\R*\St*\ST/8,{-0.25*7*\R/\St + \R*\St})
    -- (-3*\R*\St*\ST/8,5*0.25*\R/\St);
\draw (-3*\R*\St*\ST/8,-5*0.25*\R/\St)
    -- (-3*\R*\St*\ST/8,{-5*0.25*\R/\St + \R*\St})
    -- (\R*\St*\ST/8,0.25*7*\R/\St);
\draw (3*\R*\St*\ST/8,-5*0.25*\R/\St)
    -- (3*\R*\St*\ST/8,{-5*0.25*\R/\St + \R*\St})
    -- (-\R*\St*\ST/8,0.25*7*\R/\St);
\undef\R
\undef\ST
\undef\St
\node[]() at (0, -4){}; % HACK to get spacing right
\end{tikzpicture}}

Suppose there is a KS system and a non-contextual deterministic theory satisfying
the SPIN Axiom.
Then we color a point of this system~$0$,
whenever this theory predicts that the particle will deviate
if the spin is measured in the direction corresponding to that
point, and~$1$ otherwise.
Given two orthogonal points of the system,
we can find a third point orthogonal to both of them.
The SPIN axiom implies exactly one of them is colored~$1$, so they
cannot both be colored~$1$.
Similarly, given three pairwise orthogonal vectors in the system,
the SPIN axiom implies exactly one of them is colored~$1$.
Hence there would be a 010-coloring of the KS system, quod non.
Therefore a deterministic non-contextual theory cannot satisfy the
SPIN Axiom.

The KS system proposed by Kochen and Specker contained 117 points\cite{ks}.
Penrose and Peres\cite{peres} independently found a smaller system of 33 points.
The current record is the 31 point system of Conway\cite[p.~197]{qtcm}.
As pointed out by \cite{c00,aow11}, finding small KS systems
is of both theoretical and practical interest.
In public lectures, Conway himself, stressed the search for small KS
systems.\cite{OC}

Before we continue, we would like to make two remarks.
\begin{enumerate}
\item
There is an inconsistency in the literature on how to count the number
of points in a Kochen-Specker system.  One way is to take the minimal
number of points required to be non-010-colorable.
This is how we count in this paper.
Another way is to require that for every pair of orthogonal points
in the system, there is a third point orthogonal to both.
This way of counting is for example used in~\cite{pavivcic}.
\item
We consider three-dimensional Kochen-Specker systems
for two reasons.
First, every 3-dimensional system can be seen as a higher-dimensional
            system.   The converse if false.
Secondly, the size of the least Kochen-Specker system
            in dimension 4 and higher has already been found.\cite{pavivcic}
            The three-dimensional case is still open.
\end{enumerate}

\subsection{Overview}
In \cite{aow11} Arends, Ouaknine and Wampler (AOW) give a computer aided proof
that a KS system must have at least 18 vectors.  We improve their lower bound
and show that a KS system must have at least 22 vectors.

First, in Subsection~\ref{sec:ksgraphs},
we repeat a part of AOW's work, in particular the reduction of
KS systems to graphs.
The bottleneck of their search was the sheer number of graphs
and the deciding whether such graphs are embeddable.
In Section~\ref{sec:ilb},
we improve upon their reduction,
to cut down the number of graphs to consider drastically,
and state the results of our main computation.
Finally, in Section~\ref{sec:emb},
we describe our practical embeddability test.
In Section~\ref{sec:related},
we discuss related work.
The software and results of the various computations performed for
this paper, can be found here\cite{GH}.

This is an extended version of the paper published in proceedings
of the 11th workshop on Quantum Physics and Logic.\cite{UW14}
Compared to the results presented on the workshop,
we have improved the lower-bound to~$22$.
We also include new restrictions on the graph enumeration
of which we would like to emphasize~Prop.~\ref{prop:ks-enoughtriangles},
which promises to push the bound when implemented efficiently.
Furthermore we expand on methods to prove unembeddability.
Finally we discuss how the related results in the literature
compare to ours.

\subsection{Kochen-Specker graphs}
\label{sec:ksgraphs}
We follow \cite{aow11} and reduce the search for Kochen-Specker systems
to the search for a certain class of graphs.
First note that in a Kochen-Specker system we may replace a point with its
antipodal point.  They are both orthogonal to the same points and hence
the non-010-colorability is preserved.
Therefore, we may assume antipodal points are identified on the sphere.
That is: a Kochen-Specker system is a finite subset of the projective plane
that is not 010-colorable.

\begin{definition}
Given a finite subset~$S$ of the projective plane
(or equivalently, a finite subset of the northern
hemisphere without equator\footnote{%
    A subset of the projective plane can be identified with
    a subset of the closed northern hemisphere.
    For a finite subset we can always rotate in such a way
    that no points lie on the equator.}).
Define its \keyword{orthogonality graph}~$G(S)$ as follows.
The vertices are the points of~$S$.
Two vertices are joined by an edge, if their corresponding points
are orthogonal.
\end{definition}
\begin{definition}
A graph~$G$ is called~\keyword{embeddable},
if it is a subgraph of an orthogonality graph.
That is: if there is a finite subset~$S$ of the projective plane,
such that~$G \leq G(S)$.
\end{definition}
% TODO add remark on subgraph definition?
\begin{definition}
A graph is called~\keyword{010-colorable}
if there is a~$\{0,1\}$-coloring of the vertices,
with
\begin{enumerate}
\item
for each triangle there is exactly one vertex that is colored~$1$ and
\item
adjacent vertices are not both colored~$1$.
\end{enumerate}
\end{definition}


\begin{definition}
A \keyword{Kochen-Specker graph}
is an embeddable graph that is not 010-colorable.
\end{definition}
It is an easy, but important, consequence of the definitions that:
\begin{fact}
    A finite subset~$S$ of the projective plane
    is a Kochen-Specker system,
    if and only if its orthogonality graph~$G(S)$
    is Kochen-Specker.
\end{fact}

To prove there is no Kochen-Specker system on~$17$ points,
it would be sufficient to enumerate all graphs on~$17$ vertices
and check these are not 010-colorable or not embeddable.
However, this is infeasible as there are
already~${\sim}10^{26}$ non-isomorphic
graphs on~$17$ points.\cite{oeisA000088}
Luckily, we can restrict ourselves to certain classes of graphs.
\begin{proposition}[by \cite{aow11}]
    An embeddable graph is squarefree.
    That is: it does not contain the square%
    ~\begin{tikzpicture}[thick,scale=0.15,
                        line width=0.4pt,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=2pt}]
            \draw
            (0,0) node[p]{} -- (0,1) node[p]{} --
            (1,1) node[p]{} -- (1,0) node[p]{} -- (0,0);
    \end{tikzpicture}
as a subgraph.%
    \footnote{Some authors call a graph squarefree if it does not
        contain the square as induced subgraph.
        For them the complete graph on four vertices%
    ~\begin{tikzpicture}[thick,scale=0.15,
                        line width=0.3pt,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=2pt}]
            \draw
            (0,0) node[p]{} -- (0,1) node[p]{} --
            (1,1) node[p]{} -- (1,0) node[p]{} -- (0,0)
            (0,0) -- (1,1)
            (1,0) -- (0,1);
    \end{tikzpicture}
        is squarefree.
        We follow~Weisstein\cite{sf-weisstein} and~Sloane\cite{sf-sloane} and
        call a graph squarefree if it does not
        contain the square as subgraph.
        For us the complete graph on four vertices is not squarefree.}
\end{proposition}

\parpic[r]{%
\begin{tikzpicture}[scale=1.0,thick,
    partial ellipse/.style args={#1:#2:#3}{
            insert path={+ (#1:#3) arc (#1:#2:#3)}
        }]
    \draw (0,0) [partial ellipse=360:180:1 and 0.3] ;
    \draw[gray,dashed] (0,0) [partial ellipse=0:180:1 and 0.3] ;
    \draw (0,0) [rotate=315,partial ellipse=360:180:1 and 0.3] ;
    \draw[gray,dashed] (0,0) [rotate=315,partial ellipse=0:180:1 and 0.3] ;
    \draw (0,0) circle (1) ;
    \node[circle,inner sep=1pt,fill] at (90:1) {};
    \node[above] at (90:1) {$v$};
    \node[circle,inner sep=1pt,fill] at (45:1) {};
    \node[right] at (45:1) {$w$};
\end{tikzpicture}}

\begin{proof}
    Given two non antipodal points~$v\neq w$.
    See the figure on the right.
    Consider the points orthogonal to~$v$.
    This is a great circle.
    The points orthogonal to~$w$ is a different great circle.
    They intersect in precisely two antipodal points.
    Hence, if~$c$ and~$d$ are both orthogonal to~$v$ and~$w$,
    then~$c$ and~$d$ are equivalent.
    Therefore, an embeddable graph cannot contain a square.
\end{proof}

The squarefreeness is a considerable restriction.  There are
only~${\sim}10^{10}$ non-isomorphic squarefree graphs on~$17$
vertices.\cite{sf-sloane}
Next, we show we can restrict ourselves to connected graphs.
\begin{proposition}[by \cite{aow11}]\label{prop:ks-conn}
    A minimal Kochen-Specker graph is connected.
\end{proposition}
\begin{proof}
    Suppose~$G$ is a disconnected Kochen-Specker graph.
    Then one of its components is not 010-colorable.
    As a subgraph of an embeddable graph, is embeddable,
    this component is embeddable as well.
    Hence it is a smaller connected Kochen-Specker graph.
\end{proof}
The gain, however, is small.
There are only~${\sim}10^9$ non-isomorphic squarefree graphs on~$17$
vertices that are disconnected.
In our computations, checking for connectedness
required more time than would be gained by reducing the number of graphs.
Cf.~Corollary~\ref{cor:littlecon}.

We have verified the main result of \cite{aow11}:

\piccaption{AOW's 17-vertex non-010-colorable graph\label{fig:noncol17}}
\parpic[r]{%
    \begin{tikzpicture}[thick,scale=1.4,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=5pt}]
        \draw
            \foreach \x in {0,90,180,270} {
                (\x+45:1) node[p]{} -- (\x+65:1.3) node[p]{}
                (\x+45:1)  -- (\x+25:1.3) node[p]{}
                (\x+65:1.3)  -- (\x+25:1.3)
            }
            \foreach \x in {0,180} {
                (\x:0.8) node[p]{} -- (\x+25:1.3)
                (\x:0.8) -- (\x-25:1.3)
                (\x+25:1.3) -- (\x-25:1.3)
                (\x+65:1.3) -- (\x+115:1.3)
            }
            (0:0.8) -- (180:0.8)
            (90:0.2) node[p]{} -- (0:0.8)
            (90:0.2) -- (180:0.8)
            (90:0.2) -- (90:0.6) node[p]{}
            (90:0.6) -- (270+45:1)
            (90:0.6) -- (270-45:1)
            (90:0.6) -- (90+45:1)
            (90:0.6) -- (90-45:1)
            (90:0.2) -- (270:0.4) node[p]{}
            (270:0.4) -- (270+25:1.3)
            (270:0.4) -- (270-25:1.3)
            (270:0.4) -- (90+25:1.3)
            (270:0.4) -- (90-25:1.3)
        ;
\node[]() at (0, -1.4){}; % HACK to get spacing right
    \end{tikzpicture}}

\begin{comp}
There is only one non-010-colorable squarefree connected graph
on less than~$18$ vertices.  See Figure~\ref{fig:noncol17}.
It is not embeddable, as the graph in Figure~\ref{fig:unemb-10-2}
is an unembeddable subgraph.  For our proof,
see Proposition~\ref{prop:unemb-10-2}.
Hence a Kochen-Specker
system has at least 18 points.
\end{comp}

\section{An improved lower bound}
\label{sec:ilb}
Continuing the effort of Arends, Ouaknine and Wambler,
we consider another restriction.
\begin{proposition}
    A minimal Kochen-Specker graph has minimal vertex-order three.
    That is: every vertex is adjacent to at least three other vertices.
\end{proposition}
\begin{proof}
    Given a minimal Kochen-Specker graph~$G$.
    Suppose~$v$ is a vertex with order less than or equal~$2$.
    Let~$G'$ be~$G$ with~$v$ removed.
    Clearly~$G'$ is embeddable.
    Suppose~$G'$ is 010-colorable.
    Then we can extend the coloring to a coloring of~$G$ as follows.
    If~$v$ is adjacent to only one or no vertex,
    then we can color~$v$ with~$0$.
    Suppose~$v$ is adjacent to two vertices, say~$w$ and~$w'$.
    If one of~$w$ or~$w'$ is colored~$1$, we can color~$v$ with~$0$.
    If both~$w$ and~$w'$ are colored~$0$, we can color~$v$ with~$1$.
    This would imply~$G$ is 010-colorable, quod non.
    Therefore~$G'$ is a smaller
    Kochen-Specker graph, which contradicts the minimality of~$G$.
\end{proof}
There are only~${\sim}10^7$
squarefree non-isomorphic graphs on 17 vertices with minimal vertex order 3.
Even though Arends, Ouaknine and Wampler
note this restriction once,
surprisingly, they did not restrict their graph enumeration
to graphs with minimal vertex order 3.
We present another considerable restriction.

\begin{proposition}\label{prop:ks-enoughtriangles}
    In a minimal Kochen-Specker graph,
        every vertex is part of a triangle.
\end{proposition}
\begin{proof}
    Given any graph~$G$ together with a vertex~$v$ of~$G$
        such that~$v$ is not part of a triangle.
    Let~$G'$ denote~$G$ without~$v$.
    Suppose~$G'$ is~$010$-colorable.
    Then so is~$G$, as we may extend the coloring of~$G'$
        to~$G$ by coloring~$v$ with~$0$.
    Contraposing: if~$G$ is not~$010$-colorable,
        then~$G'$ is not~$010$-colorable.
    Clearly, if~$G$ is embeddable, then so is~$G'$.
    Thus if~$G$ is Kochen-Specker, then so is~$G'$.
\end{proof}
There are only~${\sim}10^5$ squarefree non-isomorphic 
graphs on 17 vertices with minimal vertex degree 3
where every vertex is part of a triangle.
Unfortunately,
we could not find an efficient algorithm
to restrict the enumeration of graphs
to those where every vertex is part of a triangle.

We continue with a strengthening of Proposition~\ref{prop:ks-conn}.
\begin{proposition}\label{prop:ks-biconn}
A minimal Kochen-Specker graph is edge-biconnected.
That is: removing any single edge leaves the graph connected.
\end{proposition}
We need some preparation, before we can prove this Proposition.
\begin{definition}
Given a graph~$G$ and a vertex~$v$ of~$G$.
We say, \keyword{$v$ has fixed color~$c$ (in~$G$)},
if~$G$ is~$010$-colorable
and for every~$010$-coloring of~$G$,
the vertex~$v$ is assigned color~$c$.
\end{definition}
We are interested in these graphs because of the following observation.
\begin{lemma}\label{lem:biconn}
If there is an embeddable graph~$G$ on~$n$ vertices with a vertex
with fixed color~$1$,
then there is a Kochen-Specker graph on~$2n$ vertices.
\end{lemma}
\begin{proof}
Let~$G$ be a graph and~$v$ a vertex of~$G$ with fixed color~$1$.
Consider two copies of the graph~$G$.
Connect the two instances of~$v$ with an edge.
Call this graph~$G'$.
Clearly, $G'$ is not~$010$-colorable.

We need to show~$G'$ is embeddable.
Given an embedding~$S$ of~$G$.
We may assume that the point in~$S$ corresponding to~$v$
is the north pole.
Furthermore, we may assume that there is no point on the $x$-axis,
by rotating points along the north pole.
Let~$S'$ be~$S$ rotated~$90$ degrees along the~$y$-axis.
Some points of~$S$ and~$S'$ might overlap.
That is: there might be a point~$s$ in~$S$ and~$s'$ in~$S'$
that are equal or antipodal.
Observe that if no points of~$S'$ and~$S$ overlap,
then~$S \cup S'$ is an embedding of~$G'$.

Suppose there are points in~$S'$ and~$S$
that overlap.
Note that the north pole (and south pole) is not in~$S'$. 
Let~$S''$ be~$S'$ rotated along the north pole at some angle~$\alpha$.
There are finitely many angles such that there are overlapping points.
Thus there is an angle such that~$S \cup S''$ is an embedding of~$G'$.
\end{proof}
Unfortunately, these graphs are not small.


\begin{comp}\label{comp:bic1}
    There are no embeddable graphs with fixed color~$1$
    on less than 17 vertices.%
        \footnote{Source code at \texttt{code/comp5.py} of \cite{GH}.}
\end{comp}
We are ready to prove that a minimal KS graph
is edge-biconnected.
\vskip7pt% HACK add space because the proof is not after a thm
\begin{myproof}[Proof of Proposition~\ref{prop:ks-biconn}]
Given a minimal Kochen-Specker graph~$G$.
\parpic[r]{%
%\parpic(0cm,1cm)[r]{%
    \begin{tikzpicture}[thick,scale=1.4,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=5pt}]
            \draw [rotate=90] (0,-0.8) ellipse (0.6 and 0.5) ;
            \draw [rotate=90] (0,0.8) circle (0.6 and 0.5) ;
            \draw 
                  (-0.7, 0.1) node[left] {$a$}
                  (0.7, 0.1) node[right] {$b$}
                  (-0.7, 0.1) node[p] {} -- (0.7, 0.1) node[p] {}
                  (-0.8, -0.6) node[below] {$A$}
                  (0.8, -0.6) node[below] {$B$}
                ;
        \end{tikzpicture}}\vspace{-0.6mm}
Recall it must be connected.  Suppose it is not edge-biconnected.
Then there must be an edge~$(a,b)$ in~$G$,
whose removal disconnects~$G$.
Thus~$G$ decomposes into two connected graphs~$A$ and~$B$
with~$a\in A$, $b \in B$ and~$(a,b)$ is the only edge
between~$A$ and~$B$.
Clearly~$A$ and~$B$ are embeddable.

Note that~$A$ must be~$010$-colorable,
for if it were not~$010$-colorable,
then~$A$ is a Kochen-Specker graph,
in contradiction with~$G$'s minimality.
Similarly~$B$ is~$010$-colorable.
Suppose there is a~$010$-coloring of~$A$ in which~$a$ is colored~$0$.
Then we can extend this coloring with any $010$-coloring of~$B$
to a~$010$-coloring of~$G$, which is absurd.
Thus~$a$ must have fixed color~$1$ in~$A$.
Similarly~$b$ must have fixed color~$1$ in~$B$.
Thus by Computation~\ref{comp:bic1},
we have~$\#A \geq 17$ and~$\#B \geq 17$.
Consequently~$\#G \geq 34$.
Contradiction with~$G$'s minimality.
\end{myproof}

We can go one step further.

\begin{proposition}\label{prop:ks-triconn}
    A minimal Kochen-Specker graph is edge-triconnected.
    That is: removing any two edges keeps the graph connected.
\end{proposition}
Again, we need some preparation.  First, we generalize
the notion of fixed color.
\begin{definition}
   Given a graph~$G$ together with selected vertices~$v_1, \ldots, v_n \in G$.
   The \keyword{type~$t$ of~$(v_1,\ldots,v_n)$ (in~$G$)}
   is the set of all possible ways $\{v_1, \ldots, v_n\}$ can be $010$-colored.
        That is:
\begin{equation*}
  t = \bigl\{ (c(v_1), \ldots, c(v_n)); \ 
        c \colon G \to \{0,1\},\ 
        \text{$c$ is a $010$-coloring of~$G$} \bigr\}
\end{equation*}
    A type of~$n$ vertices is
    called an~\keyword{$n$-type}.
\end{definition}

\begin{example}
\begin{itemize}
\item The triangle~\begin{tikzpicture}[thick,scale=0.15,
                        line width=0.4pt,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=2pt}]
            \draw
            (210:0.5) node[p]{} -- (330:0.5) node[p]{} --
            (90:0.5) node[p]{} -- (210:0.5);
    \end{tikzpicture}
has~$3$-type~$\{(1,0,0), (0,1,0), (0,0,1)\}$.
\item Every vertex in a Kochen-Specker graph has type~$\emptyset$.
\item
    A vertex~$v$ has the~$1$-type~$\{(1)\}$ in~$G$ if and only if
        it has fixed color~$1$ in~$G$.
\end{itemize}
\end{example}

Just as vertices with fixed color are rare,
we are interested in types,
because most types do not occur in small graphs.

\begin{comp}\label{comp:types}
    We have enumerated all embeddable graphs of less than~$17$ vertices
    and determined a lower bound at which a particular $1$- or $2$-type occurs,
    omitting the trivial types~$\{(0),(1)\}$
    and~$\{(0,0),(0,1),(1,0),(1,1)\}$.%
        \footnote{Source code at \texttt{code/comp5.py} of \cite{GH}.}
    \begin{center}
    \begin{tabular}{ll}
        $1/2$-type & $\#G$ \\ \hline
        $\{(0,0), (1,0), (0,1)\}$ &
            non-trivially $\geq 10$\\ 
        $\{(0,0), (1,0), (1,1)\}$ & $\geq 10$ \\
        $\{(0,0), (0,1), (1,1)\}$ & $\geq 10$ \\
        $\{(0,0), (0,1))\}$ & $\geq 15$ \\
        $\{(0,0), (1,0))\}$ & $\geq 15$ \\
        $\{(0)\}$ & $\geq 15$ \\
        $\{(0,1),(1,0)\}$ & $\geq 16$ \\
        other & $\geq 17$
    \end{tabular}
    \end{center}
    The type~$\{(0,0),(1,0),(0,1)\}$ occurs in the embeddable two-vertex
    graph
    \begin{tikzpicture}[thick,scale=1.4,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=5pt}]
            \draw
            (0,0) node[p]{} -- (0.3,0) node[p]{} ;
    \end{tikzpicture}.
    Because the two vertices are adjacent, this occurrence of
    the type is called trivial.
\end{comp}


\begin{myproof}[Proof of Proposition~\ref{prop:ks-triconn}]


    Given a minimal Kochen-Specker graph~$G$.

%\parpic(0cm,1cm)[r]{%
\parpic[r]{%
\begin{tikzpicture}[thick,scale=1.4,
p/.style={circle, draw, fill=white,
                inner sep=0pt, minimum width=5pt}]
    \draw [rotate=90] (0,-0.8) ellipse (0.8 and 0.5) ;
    \draw [rotate=90] (0,0.8) circle (0.8 and 0.5) ;
    \draw 
          (-0.7, 0.3) node[left] {$a_1$}
          (-0.7, -0.3) node[left] {$a_2$}
          (0.7, 0.3) node[right] {$b_1$}
          (0.7, -0.3) node[right] {$b_2$}
          (-0.7, -0.3) node[p] {} -- (0.7, -0.3) node[p] {}
          (-0.7, 0.3) node[p] {} -- (0.7, 0.3) node[p] {}
          (-0.8, -0.8) node[below] {$A$}
          (0.8, -0.8) node[below] {$B$}
        ;
\end{tikzpicture}}

    Suppose it is not edge-triconnected.
    Then it splits into two graphs~$A$ and~$B$
    together with vertices~$a_1, a_2 \in A$
    and~$b_1,b_2 \in B$
    such that~$(a_1, b_1)$ and~$(a_2,b_2)$
    are the only edges between~$A$ and~$B$.
    Note that~$A$ and~$B$ must be $010$-colorable,
    for otherwise~$G$ would not be a minimal Kochen-Specker graph.

    \begin{enumerate}
    \item Suppose~$a_1 = a_2$ and~$b_1 = b_2$.
                Then~$G$ is not edge-biconnected.  Contradiction with
                    Proposition~\ref{prop:ks-biconn}.
    \item Suppose~$a_1 \neq a_2$ and~$b_1 = b_2$.
        \label{tricase1}
        Suppose~$b_1=b_2$ does not have a fixed color in~$B$.
        Then any coloring of~$A$ can be extended with some coloring
        in~$B$ to a coloring of~$G$.  Contradiction.
        Apparently~$b_1=b_2$ has a fixed color in~$B$.
        \begin{enumerate}
            \item
            Suppose~$b_1=b_2$ has fixed color~$1$ in~$B$.
            Note~$\#B \geq 17$ by Computation~\ref{comp:types}.
            Suppose there is a coloring of~$A$
            in which both~$a_1$ and~$a_2$ have color~$0$.
            Then, regardless whether~$a_1$ and~$a_2$ are adjacent or not,
            this coloring can be extended with a coloring of~$B$
            (in which~$b_1=b_2$ must be colored~$1$)
            to a coloring~$G$.  Contradiction.

            Thus the type of~$(a_1,a_2)$ in~$A$ cannot contain~$(0,0)$.
            Thus, by Computation~\ref{comp:types}, $\#A \geq 17$.
            Consequently~$\#G \geq 34$. Contradiction with minimality.

            \item
            Apparently~$b_1=b_2$ has fixed color~$0$ in~$B$.
            Hence, by Computation~\ref{comp:types}, $\#B \geq 15$.
            Suppose~$a_1$ is not adjacent to~$a_2$.
            Then any coloring of~$A$ can be extended with a coloring
            of~$B$ to a coloring of~$G$. Contradiction.
            
            Apparently~$a_1$ is adjacent to~$a_2$.

            The type of~$(a_1,a_2)$ in~$A$ cannot contain~$(1,0)$
            or~$(0,1)$ for otherwise~$G$ can be colored.
            It also cannot contain~$(1,1)$ as~$a_1$ and~$a_2$
            are adjacent.
            Thus both~$a_1$ and~$a_2$ have fixed color~$0$ in~$A$.
            Hence~$\#A\geq 17$ by Computation~\ref{comp:types}.
            Consequently~$\#G \geq 32$. Contradiction
            with minimality.
        \end{enumerate}
    \item Suppose~$a_1 = a_2$ and~$b_1 \neq b_2$.
            This leads to a contradiction in the same way
            as in case~\ref{tricase1}.
    \item Apparently~$a_1 \neq a_2$ and~$b_1 \neq b_2$.
        The type of~$(a_1,a_2)$ in~$A$ cannot contain~$(0,0)$,
        for otherwise~$G$ is colorable.
        Similarly, the type of~$(b_1,b_2)$ in~$B$ cannot contain~$(0,0)$.
        Thus both~$\#A \geq 17$ and~$\#B \geq 17$.
        Hence~$\#G \geq 34$. Contradiction with minimality. \qed
    \end{enumerate}
\end{myproof}

Although these restrictions are theoretically pleasing,
they seem to be of little use as a practical restriction.
Concerning excluding disconnected graphs:
% TODO Add argument or computation for {2,3}-connected
% TODO note that restricting to (bi/tri)-connected is a waste of time
% TODO add graph 
\begin{comp}
    There are five non-isomorphic minimal
    squarefree connected graphs
    with minimal vertex order 3 and they have 10 vertices.
    \footnote{They are the first five graphs
            listed on:
    \url{http://kochen-specker.info/smallGraphs/}.}
\end{comp}
\begin{corollary}\label{cor:littlecon}
    Any disconnected
    squarefree graph with minimal vertex order 3
    has at least 20 vertices, for it has two connected components,
    each with at least 10 vertices.
    With 20 vertices, there are exactly 25 of these.
\end{corollary}
This justifies, at this stage, not checking for connectedness.
Similarly, we believe there are very few connected but not
edge-biconnected graphs.

% TODO is core x years a proper expression?
Now we can state our main computation.
\begin{comp}
    Let~$C_n$ denote the number of non-010 colorable squarefree
    graphs with minimal vertex order 3 on~$n$ nodes.  Then:%
        \footnote{Source code at \texttt{code/comp6} of \cite{GH}.}

    \begin{center}
    \begin{tabular}{l|llllll}
        $n$ & $\leq 16$
            & $17$
            & $18$
            & $19$
            & $20$
            & $21$ \\
        \hline
        $C_n$ & $0$
            & $1$
            & $2$
            & $19$
            & $441$
            & $11876$
    \end{tabular}
    \end{center}

    All these 12339 graphs are not embeddable.
    See Computation~\ref{comp:unemb20}.
\end{comp}
The computation was distributed on approximately 300 CPU cores
and took roughly three months.
It was executed as follows.
We enumerated all squarefree graphs with minimal vertex
order 3 on less than or equal~$21$ vertices\footnote{%
On 21 vertices, we found 24,888,945,914,244 such graphs.},
using the~\texttt{geng} util of the nauty software package,
which uses the isomorphism-free exhaustive generation
method of McKay\cite{geng}.
The output of~\texttt{geng}, we passed through
a custom heuristic backtracker written in~C++
to decide 010-colorability of these graphs.

\section{Embeddability}\label{sec:emb}
Our computation has yielded over nine-thousand non-010-colorable graphs.
If we show one of them is embeddable, we have found a new KS system.
If we demonstrate all of them are not embeddable, we have
proven a lower bound on the size of a minimal KS system.

In~\cite{aow11}, Arends, Wampler and Ouaknine discuss several
computer-aided methods
to test embeddability of a graph.  None of these methods could decide
for all graphs considered, whether they were embeddable or not.
% TODO give a small description of their deficiencies
% TODO give intermediate computation.
We propose a new method,
which for all graphs we considered,
could decide
whether they were embeddable or not.
But first, we give two pen-and-paper proofs of the non-embeddability
of the following graph. 
These two pictures
represent a single connected graph of minimal vertex degree three.
For presentation,
some vertices have been drawn twice.
\begin{center}
\footnotesize
\begin{tikzpicture}[thick,scale=1.4,%
        p/.style={circle, fill=white,%
                        inner sep=1pt, minimum width=5pt}]
            \draw
                (0:0) node [p] {18} (0:0.8) node [p] {3}
                (60:0.8) node [p] {10} (120:0.8) node [p] {0}
                (180:0.8) node [p] {5} (240:0.8) node [p] {12}
                (300:0.8) node [p] {9} (15:1.2) node [p] {13}
                (45:1.2) node [p] {14} (75:1.2) node [p] {4}
                (105:1.2) node [p] {6} (135:1.2) node [p] {15}
                (165:1.2) node [p] {11} (195:1.2) node [p] {16}
                (225:1.2) node [p] {1} (255:1.2) node [p] {7}
                (285:1.2) node [p] {17} (315:1.2) node [p] {2}
                (345:1.2) node [p] {8}
                \foreach \x in {0, 120, 240} { (\x:0.8) -- (\x-60:0.8) }
                \foreach \x in {0,60,120,180,240,300} {
                    (0:0) -- (\x:0.8) (\x:0.8) -- (\x+15:1.2) 
                    (\x:0.8) -- (\x-15:1.2) (\x+15:1.2) -- (\x-15:1.2)
                }
            ;
    \end{tikzpicture}\qquad
\begin{tikzpicture}[thick,scale=1.4,%
        p/.style={circle, fill=white,%
                        inner sep=1pt, minimum width=5pt}]
            \draw
                (90:0.3) node[p] {14} (210:0.3) node[p] {8}
                (330:0.3) node[p] {1} (90:0.8) node[p] {4}
                (210:0.8) node[p] {13} (330:0.8) node[p] {7}
                (60:1.3) node[p] {17} (120:1.3) node[p] {11}
                (180:1.3) node[p] {16} (240:1.3) node[p] {6}
                (300:1.3) node[p] {15} (0:1.3) node[p] {2}
                \foreach \x in {90, 210, 330} {
                    (\x:0.3) -- (\x+120:0.3)
                    (\x:0.3) -- (\x:0.8)
                    (\x:0.8) -- (\x+30:1.3)
                    (\x:0.8) -- (\x-30:1.3)
                    (\x-30:1.3) -- (\x+30:1.3)
                    (\x+30:1.3) -- (\x-30+120:1.3)
                }
            ;
    \end{tikzpicture}
\end{center}
\subsection{First pen-and-paper proof}
Of the graphs of 19 vertices,
the above graph was the
the only not excluded by the unembeddable graphs
known by AOW.
%[referentie naar IpD?GUbV?].
In order to show that this graph is not embeddable,
we proceeded as follows.
If the graph is embeddable, there is always an embedding such that
the coordinates on the sphere of some triangle in this graph
are~$(1,0,0)$, $(0,1,0)$ and~$(0,0,1)$.
We chose to assign these values
to the points 0, 10 and~18, respectively. For each of these vertices,
any vertex adjacent to it
must lie on a certain great circle.
For example, we can assign to the vertices 9 and 3, which
are both connected to 18, the coordinates~$(\sqrt{1-x^{2}}, -x,0)$
and~$(x,\sqrt{1-x^{2}},0)$, for some $x\in(-1,1)$ and~$x\neq 0$.
We find similar
expressions for the coordinates of the other triangles containing the
vertices 0, 10 and 18. The remaining vertices are assigned a variable
value on the sphere, where we always choose the component containing
the square-root positive, so we obtain coordinates of the
form~$(a,b,\sqrt{1-a^2-b^2})$, for $a,b \in (-1,0)\cup (0,1)$.
In this way we
obtain no variables for the first triangle, 4 for attached triangles
and then 16 for the left over vertices giving 20 unknowns. The
relations for these variables are given by the fact that the inner
product of the vectors should be zero if they are adjacent. Not
counting the inner products that are trivially zero, we obtain 24
equations. By tedious calculations, one
derives the equation $x^2(1-x^2) = -1$, which is not satisfiable.
Hence this system is not embeddable.

If we only consider the points used to obtain the
contradiction, we find an unembeddable subgraph of the system
containing 13 vertices\footnote{These are the vertices
0,2,3,4,6,8,9,10,13,14,15,17 and 18.}.
In the appendix we included the  derivation of contradiction.
In theory, this approach can be mechanically performed by
a computer.  However, there are too many variables
to solve this in reasonable time.

\subsection{Second pen-and-paper proof}
We give a second simpler pen-and-paper proof of the unembeddability
of the graph, by showing a subgraph is unembeddable.

\piccaption{One of the two minimal non-embeddable graphs \label{fig:unemb-10-2}}
\parpic[r]{%
\begin{tikzpicture}[thick,scale=1.4,%
        p/.style={circle, draw, fill=white,%
                        inner sep=0pt, minimum width=5pt}]
            \draw
                \foreach \x in {90,210,330} {
                    (\x:0.7) -- (0:0)
                    (\x-30:1.3) -- (\x:0.7)
                    (\x+30:1.3) -- (\x:0.7)
                    (\x-30:1.3) -- (\x+30:1.3) 
                    (\x+30:1.3) -- (\x-30+120:1.3) 
                }
                (90:0.7) node[p]{}
                (210:0.7) node[p]{}
                (330:0.7) node[p]{}
                (0:0) node[p]{}
                (90+30:1.3) node[p]{}
                (90-30:1.3) node[p]{}
                (210+30:1.3) node[p]{}
                (210-30:1.3) node[p]{}
                (330+30:1.3) node[p]{}
                (330-30:1.3) node[p]{}
                (90:0.7) node[above]{$w$}
                (210:0.7) node[above]{$v$}
                (330:0.7) node[above]{$x$}
                (0:0) node[below]{$z$}
                (90+30:1.3) node[above]{$p_3$}
                (90-30:1.3) node[above]{$p_4$}
                (210+30:1.3) node[below]{$p_1$}
                (210-30:1.3) node[left]{$p_2$}
                (330+30:1.3) node[right]{$p_5$}
                (330-30:1.3) node[below]{$a$} ;
\node[]() at (0, -1.5){}; % HACK to get spacing right
\end{tikzpicture}}
\par\noindent\parbox{\textwidth}{%
\begin{proposition}\label{prop:unemb-10-2}
The graph in Figure~\ref{fig:unemb-10-2}
is not embeddable.
\end{proposition}}
\begin{myproof}
Suppose it is embeddable.
Consider (the point associated to)~$p_1$.
It is orthogonal to both~$a$ and~$v$.
Since $a$ and~$v$ are not collinear,
$p_1$ must be collinear to~$v \times a$,
the cross-product of~$v$ and~$a$.
Similarly, $p_2$ is collinear to~$v \times p_1 = v \times (v \times a)$.
Continuing in this fashion, walking the circumference of the graph,
we find
\par\vskip-\lastskip % HACK to prevent eq. to mess with parpic
\begin{equation}\label{eq:ue1}
    a \text{ is collinear to }
    x \times (x \times( w \times (w\times (v \times (v \times a))))).
\end{equation}
Now, we may assume that~$z=(0,0,1)$ and $x=(1,0,0)$.
Thus: $v=(v_1,v_2,0)$;
$w = (w_1,w_2,0)$
and $a = (0, a_2,a_3)$ for some~$-1 \leq v_1,v_2,w_1,w_2,a_2,a_3 \leq 1$,
with~$v_1^2+v_2^2 = 1$; $w_1^2+w_2^2=1$ and~$a_2^2 + a_3^2=1$.
Now, \eqref{eq:ue1} becomes:
\begin{equation*}
\begin{pmatrix}
0\\
a_2\\
a_3\\
\end{pmatrix}
\text{ is collinear to }
\begin{pmatrix}
0\\
-a_2 v_1w_2 (v_1w_1 + v_2w_2) \\
-a_3 (v_1^2 w_1^2 + v_1^2 w_2^2 + v_2^2w_1^2 + v_2^2w_2^2)\\
\end{pmatrix}.
\end{equation*}
Consequently
\begin{align*}
    v_1w_2 (v_1w_1 + v_2w_2)
& = v_1^2 w_1^2 + v_1^2 w_2^2 + v_2^2w_1^2 + v_2^2w_2^2 \\
& = (v_1^2 + v_2^2)w_1^2 + (v_1^2 + v_2^2)w_2^2 \\
& = w_1^2 + w_2^2 \\
&= 1.
\end{align*}
Since~$v$ and~$w$ are not collinear,
we have by Cauchy-Schwarz $|\left<v,w\right>| < 1$. Thus
\begin{equation*}
1 > |v_1w_2\left<v,w\right>| = |v_1w_2(v_1w_1+v_2w_2)| = 1,
\end{equation*}
which is a contradiction.  Apparently this graph is not embeddable.
\end{myproof}

% TODO Can we prove: if G is embeddable, then we can add any new vertex of
%      order 2 and G is still embeddable?

\subsection{An algorithm to decide embeddability}
In the previous proof, we fixed, without loss of generality, the position
of a few vertices.  Then we derived cross-product expressions for the
remaining vertices.  Finally, we found an equation relating some of
the cross-product expressions and show it is unsatisfiable.
We automate this reasoning as follows.

\begin{algorithm}
\begin{algorithmic}[5]
    \While{there are unassigned vertices}
        \State pick an unassigned vertex~$v$
        \State assign~$V(v)=v$ 
        \State mark~$v$ as free
        \While{there are unassigned vertices adjacent to two
                distinct assigned}
            \State pick such a vertex~$w$ adjacent to the
                    assigned ~$w_1$ and~$w_2$
            \State assign~$V(w)=V(w_1) \times V(w_2)$
            \State mark edges~$(v,w_1)$ and~$(v,w_2)$ as accounted for
        \EndWhile
    \EndWhile
    \pagebreak[2]
    \For{each pair of vertices~$(v_1, v_2)$}
        \If{$(v_1,v_2)$ is not an edge}
            \State record requirement:~``$V(v_1)$
                    is not collinear to $V(v_2)$''
        \EndIf
    \EndFor
    \For{each edge~$(v_1,v_2)$ not accounted for}
        \State record requirement:~``$V(v_1)$ is orthogonal to~$V(v_2)$''
    \EndFor
\end{algorithmic}
\end{algorithm}

At two points in the algorithm, there is a choice which vertex to pick.
Depending on the vertices chosen, the number of recorded requirements
and free points may significantly vary. By considering all possible choices,
one can find the one with least free points.

The requirements can be mechanically converted
to a formal sentence
in the language of the real numbers.
This sentence is true if and only if the graph is embeddable.
Famously, Tarski proved\cite{tarski}
that such sentences are decidable.
His decision procedure has an impractical complexity.
However, its practical value has been improved
by, for instance, the method of cylindrical algebraic decomposition\cite{qecad}.
We have used the redlog\cite{redlog} package of the reduce algebra
system, which implements a variant of Tarski's quantifier
elimination.\footnote{%
    The reader can find the reduce script generated mechanically
    for the graph in Figure~\ref{fig:unemb-10-2} here:
    \url{http://kochen-specker.info/smallGraphs/49743f49514769444f.html}.  }

Different assignments give different sentences.  In our tests,
some assignments would yield sentences that were decided within milliseconds,
whereas another assignment with less free vertices would
yield a sentence that could not be decided (directly).
Therefore, when determining embeddability of a graph,
we try several assignments in parallel.

Using this algorithm, we could determine embeddability for most graphs
with less than 15 vertices.  However, there were  a few (010-colorable)
graphs for which the algorithm would not terminate and hence
their embeddability was not decided.
By hand, we found with trial and error an embedding for
some of these graphs.
Once we knew the troublesome graphs were embeddable,
we adapted the algorithm, as to guess
for some assignments the position of one of the vectors.
If the corresponding
sentence turns out false, we know nothing.  However,
if the sentence is true, we know the graph is embeddable.

With this method, we have decided in a day the embeddability
of every squarefree graph with minimal vertex order three of
less than 15, except for one.\footnote{%
A list of all squarefree graphs with minimal vertex order three of
less than 15 vertices together with their embeddability can
be found here:
\url{http://kochen-specker.info/smallGraphs/}.
The graph for which we could not determine
embeddability can be found
here: \url{http://kochen-specker.info/smallGraphs/4d4b3f4b3f603f47414641654953625f3f.html}.
}
In particular:
\begin{comp}\label{comp:unemb20}
Every squarefree graph of minimal vertex order three that is
not~$010$-colorable of order less than or equal 21
contains an unembeddable subgraph.%
\footnote{A list of these graphs together with their unembeddable
subgraphs, can be found here:
\url{http://kochen-specker.info/candidates/}.
The source code for this computation can be found
at~\texttt{code/comp2.py} of~\cite{GH}.}
In particular, those of order less than or equal 20
    contains, as a subgraph, one of the following three graphs:
    \begin{center}
    \begin{tikzpicture}[thick,scale=1.0,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=5pt}]
            \draw
                \foreach \x in {90,210,330} {
                    (\x:0.7) node[p]{} -- (0:0) node[p]{}
                    (\x-30:1.3) node[p]{} -- (\x:0.7)
                    (\x+30:1.3) node[p]{} -- (\x:0.7)
                    (\x-30:1.3) -- (\x+30:1.3) 
                    (\x+30:1.3) -- (\x-30+120:1.3) 
                }
            ;
        \end{tikzpicture}
        \qquad
    \begin{tikzpicture}[thick,scale=1.0,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=5pt}]
            \draw
                \foreach \x in {0,180} {
                    (\x+15:1.3) node[p]{} -- (\x+90:0.9) node[p]{}
                    (\x+15:1.3) -- (\x+45:0.5) node[p]{}
                    (\x+45:0.5) -- (\x+90:0.9)

                    (\x-15:1.3) node[p]{} -- (\x-90:0.9)
                    (\x-15:1.3) -- (\x-45:0.5) node[p]{}
                    (\x-45:0.5) -- (\x-90:0.9)

                    (\x-15:1.3) -- (\x+15:1.3)
                }
                (45:0.5) -- (45+180:0.5)
                (45+90:0.5) -- (45+90+180:0.5)

            ;
        \end{tikzpicture}
        \qquad
    \begin{tikzpicture}[thick,scale=1.0,
        p/.style={circle, draw, fill=white,
                        inner sep=0pt, minimum width=5pt}]
            \draw
                (45:0.5) node[p]{} -- (135:0.5) node[p]{}
                                -- (225:0.5) node[p]{}
                                -- (315:0.5) node[p]{}
                (15:1.3) node[p]{}
                (345:1.3) node[p]{}
                (195:1.3) node[p]{}
                (165:1.3) node[p]{}

                (75:1) node[p]{} -- (15:1.3) -- (45:0.5) -- (75:1)
                (285:1) node[p]{} -- (345:1.3) -- (315:0.5) -- (285:1)

                (0:1.3) node[p]{} -- (180:0.8) node[p]{}
                (0:1.3) -- (15:1.3)
                (0:1.3) -- (345:1.3)

                (180:0.8) -- (195:1.3)
                (180:0.8) -- (165:1.3)
                (195:1.3) -- (165:1.3)
                (180:0.8) -- (225:0.5)
                (180:0.8) -- (135:0.5)
                (195:1.3) -- (285:1)
                (165:1.3) -- (75:1)

            ;
        \end{tikzpicture}
    \end{center}
    These three graphs are unembeddable.  The left and middle graph
    are the only minimal unembeddable squarefree graph.
For the first graph, we have proven directly that it is unembeddable.
See Proposition~\ref{prop:unemb-10-2}.
For the second graph, we also have a similar direct proof. The third graph is shown to not be embeddable using our algorithm.
\end{comp}

\section{Related work}
\label{sec:related}
This paper improves the lower bound of
Arends, Ouaknine and Wampler\cite{a09,aow11}
on the size of a minimal Kochen-Specker system.
Pavi\v{c}i\'c, Merlet, McKay and Norman\cite{pavivcic}
count the size of a Kochen-Specker system differently
and have demonstrated a different bound.
\begin{definition}
    A Kochen-Specker graph is called \keyword{complete}
        if every edge is part of a triangle.
\end{definition}
Pavi\v{c}i\'c et al have given a lower bound on the size
of the minimal \emph{complete} Kochen-Specker system.
Similar to our approach, they reduce the problem
to a question about discrete structures
which can be considered as a subclass of graphs.
They discovered several uncolorable candidates
of which they could prove unembeddability
using either symbolic computation or interval analysis.

Clearly, a bound on the minimal size of a KS system
is also a bound on the minimal size of a complete system.
Conversely, a KS system can be completed by adding missing vectors.
However, it is not clear how many vectors have to be added in general
to complete the system.
A history of the different bounds on 3-dimensional Kochen-Specker
systems is given in the table below.
\begin{center}
    \begin{tabular}{llll}
        Authors & year & KS & complete KS \\ \hline
        Kochen and Specker\cite{ks} & 1975 & $\leq 117$ & $\leq 192$ \\
        Penrose, Peres\cite{peres}
                (independendly)& 1991 & $\leq 33$ & $\leq 57$ \\
        Conway & $\sim$1995 & $\leq 31$ & $\leq 51$ \\
        UW\cite{UW14} & 2014 & $\geq 22$ & $\geq 22$ \\
        Pavi\v{c}i\'c et al.\cite{pavivcic}& 2004 & $?$ & $\geq 30$ \\
    \end{tabular}
\caption{A history of the bounds on the size of the minimal
    (complete) three-dimensional Kochen-Specker system.}
\end{center}


\section{Conclusion and future research}
Arends, Ouaknine and Wampler struggled with two problems:
enumerating candidate graphs of less than 31 vertices
and testing their embeddability.
We have verified most of their computations.
Then we enumerated all candidate graphs
up to and including 21 vertices.
Furthermore, we have proposed a new decision procedure,
which was able to decide embeddability
for all candidate graphs we found.
Therefore, we demonstrate: a Kochen-Specker system must have at least
22 points.\footnote{%
The authors have a wager whether there is a minimal KS system of less
than 25 vertices.}

Enumerating all candidate graphs of less than 31 vertices
is computationally infeasible.
To bridge the enormous the gap between 22 and 31,
requires a new insight.
Most likely, this would be a new
practical restriction on which graphs to consider.
In particular
(following Prop.~\ref{prop:ks-enoughtriangles})
a fast algorithm to enumerate
square-free graphs of minimal vertex order three
where each node is part of a triangle,
would probably allow to test for KS-systems
up to and including 24 vertices.

The Reader, interested in pursuing this line of research,
is encouraged to read the master thesis\cite{a09} of Arends,
in which he discusses in detail several other
properties that a minimal KS system must enjoy, as well as
some failed attempts.

\begin{acknowledgment}
We wish to thank the following for their generous contribution to the
distributed computation:
    the Digital Security group, Intelligent Systems group
    and the C\&CZ service of the Radboud University;
    Wouter Geraedts and
    Jille Timmermans.

We are grateful to prof.~McKay for discussing the feasibility of
certain graph restrictions; to Bas Spitters for showing us the
article of Arends, Ouaknine and Wampler \emph{and} to Judith van
Stegeren\footnote{\url{http://jd7h.com/}} for drawing figures for
the draft version of this paper.
\end{acknowledgment}

\clearpage
\bibliography{main}{}
\bibliographystyle{plain}

\appendix
\clearpage
\section{Appendix}
In this appendix, we show by hand, that indeed the 19 vertex graph
considered at the start of section 3 %TODO
is not embeddable.
We restrict the calculation to the~$13$-vertex unembeddable
subgraph.

\begin{center}
    \footnotesize
    \begin{tikzpicture}[thick,scale=3.5,
        p/.style={fill=white, circle, inner sep=1pt, minimum width=45pt}]
        \draw

                (45:0.9) node[p, align=center]{0 \\ $(1,0,0)$} -- (65:1.3) node[p, align=center]{6 \\$(0,x_3,\cdot)$}
                (45:0.9)  -- (25:1.3) node[p, align=center]{15 \\ $(0,\cdot,\text{-}x_3)$}
                (65:1.3)  -- (25:1.3)
            
                (90+45:0.9) node[p, align=center]{3 \\ $(\cdot,\text{-}x_1,0)$} -- (90+65:1.3) node[p, align=center]{8 \\ $(g,h,\cdot)$ }
                (90+45:0.9)  -- (90+25:1.3) node[p, align=center]{13 \\ $(e,f,\cdot)$}
                (90+65:1.3)  -- (90+25:1.3)
            
                (180+45:0.9) node[p, align=center]{10 \\ $(0,1,0)$} -- (180+65:1.3) node[p, align=center]{4 \\ $(x_2,0,\cdot)$}
                (180+45:0.9)  -- (180+25:1.3) node[p, align=center]{14 \\ $(\cdot,0,\text{-}x_2)$}
                (180+65:1.3)  -- (180+25:1.3)

                (270+45:0.9) node[p, align=center]{9 \\$(x_1,\cdot,0)$} -- (270+65:1.3) node[p, align=center]{2 \\ $(a,b,\cdot)$}
                (270+45:0.9)  -- (270+25:1.3) node[p, align=center]{17 \\ $(c,d,\cdot)$}
                (270+65:1.3)  -- (270+25:1.3)
   
             
            
            \foreach \x in {0,180} {
                (\x+25:1.3) -- (\x-25:1.3)
                (\x+65:1.3) -- (\x+115:1.3)
           }
 

        (90:0.6) -- (90:0.6)  node[p, align=center]{18 \\ $(0,0,1)$}
        (90:0.6) -- (270+45:0.9)
        (90:0.6) -- (270-45:0.9)
        (90:0.6) -- (90+45:0.9)
	(90:0.6) -- (90-45:0.9)

(45:1)--(225:1)
(135:1)--(315:1) ;
    \end{tikzpicture}
\end{center}

This is the subgraph and we have given the vertices names corresponding
to the original, 19 vertex, graph. Below each name is a coordinate
on the sphere (whenever there is a $\cdot$ in the coordinate, we
mean that this component of the coordinate is fixed by the other
components, as it must be a point on the sphere, where we take
this $\cdot$ to be the positive square root).

Now if two vertices are connected via an edge, we have that the
inner product of their coordinates is zero. Vertices connected to
the points 0,10 and 18 are trivially zero. The non trivial equations
then become:
\begin{align}
&ax_1 + b\sqrt{1-{x_1}^2}=0\\
&cx_1 + d\sqrt{1-{x_1}^2}=0\\
&e\sqrt{1-{x_1}^2} - fx_1=0\\
&g\sqrt{1-{x_1}^2} - hx_1=0\\
&g\sqrt{1-{x_2}^2} - x_2 \sqrt{1-g^2-h^2}=0\\
&cx_2 + \sqrt{1-{x_2}^2}\sqrt{1-c^2-d^2}=0\\
&b\sqrt{1-{x_3}^2} - x_3 \sqrt{1-a^2-b^2}=0\\
&fx_3 + \sqrt{1-e^2-f^2}\sqrt{1-{x_3}^2}=0\\
&ac + bd + \sqrt{1-a^2-b^2}\sqrt{1-c^2 - d^2} = 0\\
&eg + fh + \sqrt{1-e^2-f^2}\sqrt{1-g^2 - h^2} = 0
\end{align}

From the equations containing only $x_1$ we can eliminate four variables.
\begin{equation}
b = \frac{-a x_1}{\sqrt{1-{x_1}^2}} \tag{1'}
\end{equation}
\begin{equation}
d = \frac{-c x_1}{\sqrt{1-{x_1}^2}} \tag{2'}
\end{equation}
\begin{equation}
e = \frac{f x_1}{\sqrt{1-{x_1}^2}} \tag{3'}
\end{equation}
\begin{equation}
g = \frac{h x_1}{\sqrt{1-{x_1}^2}} \tag{4'}
\end{equation}
Note that this is possible since all $x_i \in (-1,1)\backslash
\{0\}$ since otherwise we would have coinciding coordinates of
vertices in the graph.

Substituting these expressions in the other six equations and using
that~$\tfrac{x}{1-x} +1 = \tfrac{1}{1-x}$, we obtain:

\begin{align}
&\frac{h x_1}{\sqrt{1-{x_1}^2}}\sqrt{1-{x_2}^2} - x_2 \sqrt{1-\frac{h^2}{1-{x_1}^2}}=0 \tag{5'}\\
&cx_2 + \sqrt{1-{x_2}^2}\sqrt{1-\frac{c^2}{1-{x_1}^2}}=0 \tag{6'}\\
&\frac{-a x_1}{\sqrt{1-{x_1}^2}}\sqrt{1-{x_3}^2} - x_3 \sqrt{1-\frac{a^2}{1-{x_1}^2}}=0\tag{7'}\\
&fx_3 + \sqrt{1-\frac{f^2}{1-{x_1}^2}}\sqrt{1-{x_3}^2}=0\tag{8'}\\
&ac + \frac{-a x_1}{\sqrt{1-{x_1}^2}}\frac{-c x_1}{\sqrt{1-{x_1}^2}} + \sqrt{1-\frac{a^2}{1-{x_1}^2}}\sqrt{1-\frac{c^2}{1-{x_1}^2}} = 0 \tag{9'}\\
&\frac{f x_1}{\sqrt{1-{x_1}^2}}\frac{h x_1}{\sqrt{1-{x_1}^2}} + fh + \sqrt{1-\frac{f^2}{1-{x_1}^2}}\sqrt{1-\frac{h^2}{1-{x_1}^2}} = 0\tag{10'}
\end{align}

These can then almost trivially be rewritten to:

\begin{align}
&h x_1\sqrt{1-{x_2}^2} - x_2 \sqrt{1-{x_1}^2 - h^2}=0 \tag{5''}\label{5''}\\
&cx_2\sqrt{1-{x_1}^2} + \sqrt{1-{x_2}^2}\sqrt{1-{x_1}^2 - c^2}=0\tag{6''}\label{6''}\\
&a x_1\sqrt{1-{x_3}^2} + x_3 \sqrt{1-{x_1}^2 - a^2}=0\tag{7''}\label{7''}\\
&fx_3\sqrt{1-{x_1}^2} + \sqrt{1-{x_1}^2 - f^2}\sqrt{1-{x_3}^2}=0\tag{8''}\label{8''}\\
&ac + \sqrt{1- {x_1}^2 - a^2}\sqrt{1- {x_1}^2 - c^2} = 0\tag{9''}\label{9''}\\
&fh + \sqrt{1- {x_1}^2 - f^2}\sqrt{1- {x_1}^2 - h^2} = 0\tag{10''}\label{10''}
\end{align}

It then follows from \eqref{7''}, \eqref{9''} and \eqref{6''} that:
\begin{eqnarray*}
\frac{\sqrt{1-{x_3}^2}}{x_3} &=& \frac{-\sqrt{1-{x_1}^2 - a^2}}{ax_1}\\
&=& \frac{c}{x_1 \sqrt{1-{x_1}^2 -c^2}}\\
&=& \frac{-\sqrt{1-{x_2}^2}}{x_1 x_2 \sqrt{1-{x_1}^2}}
\end{eqnarray*}

While using \eqref{5''},\eqref{10''} and \eqref{8''} we find that:
\begin{eqnarray*}
\frac{\sqrt{1-{x_2}^2}}{x_2} &=& \frac{\sqrt{1-{x_1}^2 - h^2}}{hx_1}\\
&=& \frac{-f}{x_1 \sqrt{1-{x_1}^2 -f^2}}\\
&=& \frac{\sqrt{1-{x_3}^2}}{x_1 x_3 \sqrt{1-{x_1}^2}}
\end{eqnarray*}

Inserting this expression for $\frac{\sqrt{1-{x_2}^2}}{x_2}$ into
the expression for $\frac{\sqrt{1-{x_3}^2}}{x_3}$ we obtain the
equation:

\begin{equation}
\frac{\sqrt{1-{x_3}^2}}{x_3} = \frac{-\sqrt{1-{x_3}^2}}{x_3 {x_1}^2  (1-{x_1}^2)}
\end{equation}
But then, eliminating the $x_3$ terms we find:
\begin{equation}
{x_1}^2 (1-{x_1}^2) = -1
\end{equation}
Which is our desired contradiction.


\end{document}

% vim: ft=tex.latex
